<!DOCTYPE html>

<html lang="ja">

<HEAD>
<title>CmdFreak</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="./style.css" type="text/css">
</HEAD>

<BODY>
<div id="container">
<H1>2. インストール／アンインストール</H1>


<H2 ID="2.1">2.1 インストール方法</H2>
<div class="topic">
cmdfreak.msi を起動することにより，CmdFreakのインストーラが起動します。
インストーラの指示に従いダイアログを操作してください。<br>
CmdFreakのインストーラは，インストール時に以下の操作を行います。<br>
<ul>
<li>CmdFreakに対するWindowsファイアウォールへの例外登録。
<li>CmdFreakサービスのシステムへの登録。
<li>CmdFreakサービスおよびWebサーバの自動起動。
</ul>
CmdFreak インストール後にcmdfreak.msi を起動するとプログラムの上書きインストール(Repair) を行うことができますが，
その際下記の事項について注意する必要があります。<br>
<ul>
<li>上書きインストール実行前にCmdFreakのサービスを停止してください。停止せずに上書きインストールを実行すると，上書きインストール後にオペレーティングシステムの再起動が必要になります。
<li>上書きインストール後にWebサーバおよびCmdFreak サービスが使用するポート番号がデフォルトに変更される場合があります。必要に応じて上書きインストール後にポート番号を変更してください。
</ul>
</div><p>


<H2 ID="2.2">2.2 アンインストール方法</H2>
<div class="topic">
cmdfreak.msi を起動してRemove CmdFreakを選択するか，コントロールパネルからCmdFreakのアンインストールを行ってください。<br>
CmdFreakのアンインストールは，アンインストール時に以下の操作を行います。<br>
<ul>
<li>CmdFreakサービスおよびWebサーバの自動停止。
<li>CmdFreakサービスのシステムからの削除。
<li>CmdFreakに対するWindowsファイアウォールからの例外削除。
</ul>
</div><p>


<H2 ID="2.3">2.3 CmdFreakへの接続方法</H2>
<div class="topic">
CmdFreakのインストール後，Webブラウザから下記のURLに接続してください。
CmdFreakのメインコンソールが表示されていれば，インストールは問題なく完了しています。<p>
http://＜CmdFreakのインストール先ホスト名またはIPアドレス＞:＜Webサーバのポート番号＞<p>
メインコンソールが表示されない場合，またはエラーが表示される場合下記を確認してください。
<ul>
<li>ブラウザからCmdFreakへの接続でURLにホスト名を指定している場合，ホスト名からIPアドレスが名前解決できること。
名前解決できない場合，名前解決可能なホストに変更し，再度接続を試みてください。
<li>CmdFreak(nginx.exe)がWindowsのファイアウォールに例外登録されていること。
例外登録されていない場合，nginx.exe をファイアウォールの例外に登録してください。
<li>stkwebapp.exe およびnginx.exe がタスクマネージャのプロセス一覧に表示されること。
プロセス一覧に表示されない場合，スタートメニューからCmdFreakのサービスを起動してください。
<li>WebサーバおよびCmdFreakサービスが使用するポート番号が他のプロセスが使用するポート番号と重なっていないこと。
後述のポート番号の変更手順に従い，ポート番号が重ならないよう変更を行ってください。
</ul>
</div><p>


<H2 ID="2.4">2.4 CmdFreakサービスの起動・停止</H2>
<div class="topic">
CmdFreakサービスの起動および停止は，以下のコマンドを使って行います。<br/>
<p>＜CmdFreakのインストールフォルダ＞\CmdFreak\stkwebappcmd.exe</p>
<ul>
<li>
CmdFreakサービスの起動<br/>
コマンドプロンプトを管理者として実行し，コマンドプロンプトで次のコマンドを実行します。<br/>
<p>＜CmdFreakのインストールフォルダ＞\CmdFreak\stkwebappcmd.exe start ProductName=CmdFreak</p>
</li>
<li>
CmdFreakサービスの停止<br/>
コマンドプロンプトを管理者として実行し，コマンドプロンプトで次のコマンドを実行します。<br/>
<p>＜CmdFreakのインストールフォルダ＞\CmdFreak\stkwebappcmd.exe stop ProductName=CmdFreak</p>
</li>
</ul>
</div><p>


<H2 ID="2.5">2.5 IPアドレスおよびポート番号の変更</H2>
<div class="topic">
CmdFreakは，2種類のIPアドレスとポート番号を使用します。<br/>
<ul>
<li>WebサーバのIPアドレスとポート番号</li>
<li>CmdFreakサービスのIPアドレスとポート番号</li>
</ul><br/>

インストール後にこれらのIPアドレスおよびポート番号を変更するためには，以下の手順で操作を行ってください。<br/>
<ol>
<li>CmdFreakサービスを停止します。</li>
<li>
IPアドレスおよびポート番号を変更します。<br/>
<p>
<u>CmdFreakサービスが使用するIPアドレスおよびポート番号を変更する場合:</u><br/>
＜インストール先フォルダ＞\CmdFreak\stkwebapp.conf のservicehostおよびserviceport プロパティにCmdFreakサービスのIPアドレスおよびポート番号を設定します。<br/>
＜インストール先フォルダ＞\CmdFreak\conf\nginx.conf のlocation /api/ セクションのproxy_pass にCmdFreakサービスのIPアドレスおよびポート番号を設定します。<br/>
</p>
<p>
<u>Webサーバが使用するIPアドレスおよびポート番号を変更する場合:</u><br/>
＜インストール先フォルダ＞\CmdFreak\conf\nginx.conf のlistenおよびserver_name を変更します。<br/>
</p>
</li>
<li>必要に応じてファイアウォールの設定を変更します。</li>
<li>CmdFreakサービスを起動します。</li>
</ol>
</div><p>

</div>
</BODY>

</html>
